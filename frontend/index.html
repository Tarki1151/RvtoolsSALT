<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RVTools Visualization Dashboard</title>
    <meta name="description" content="VMware RVTools veri görselleştirme ve analiz dashboard'u">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <img src="images/logo-square.png" alt="RVTools" class="logo-img">
                <span>RVTools</span>
            </div>
        </div>

        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-page="dashboard">
                <i class="fas fa-chart-pie"></i>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-page="vms">
                <i class="fas fa-desktop"></i>
                <span>Virtual Machines</span>
            </a>
            <a href="#" class="nav-item" data-page="hosts-clusters">
                <i class="fas fa-cubes"></i>
                <span>Hosts & Clusters</span>
            </a>
            <a href="#" class="nav-item" data-page="datastores">
                <i class="fas fa-database"></i>
                <span>Datastores</span>
            </a>
            <a href="#" class="nav-item" data-page="optimization">
                <i class="fas fa-chart-line"></i>
                <span>Optimizasyon</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="source-selector">
                <label>Veri Kaynağı</label>
                <select id="source-filter">
                    <option value="">Tüm Kaynaklar</option>
                </select>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 id="page-title">Dashboard</h1>
            </div>
            <div class="header-right">
                <!-- PDF Export (visible only on Optimization page) -->
                <div class="pdf-dropdown" id="header-pdf-dropdown" style="display: none;">
                    <button class="btn btn-pdf" id="pdf-dropdown-btn">
                        <i class="fas fa-file-pdf"></i> PDF İndir <i class="fas fa-caret-down"></i>
                    </button>
                    <div class="pdf-dropdown-content" id="pdf-dropdown-content">
                        <a href="#" onclick="window.exportOptimizationPDF('all'); return false;"><i
                                class="fas fa-file-download"></i> Tüm Raporlar</a>
                        <a href="#" onclick="window.exportOptimizationPDF('rightsizing'); return false;"><i
                                class="fas fa-balance-scale"></i> Right-Sizing</a>
                        <a href="#" onclick="window.exportOptimizationPDF('diskwaste'); return false;"><i
                                class="fas fa-trash-alt"></i> Disk Waste</a>
                        <a href="#" onclick="window.exportOptimizationPDF('zombies'); return false;"><i
                                class="fas fa-ghost"></i> Zombie Disks</a>
                        <hr style="margin: 5px 0; border-color: rgba(255,255,255,0.1);">
                        <a href="#" onclick="window.exportOptimizationPDF('POWERED_OFF_DISK'); return false;"><i
                                class="fas fa-power-off"></i> Kapalı VM (Disk)</a>
                        <a href="#" onclick="window.exportOptimizationPDF('CPU_UNDERUTILIZED'); return false;"><i
                                class="fas fa-chart-line"></i> Düşük CPU Kullanımı</a>
                        <a href="#" onclick="window.exportOptimizationPDF('EOL_OS'); return false;"><i
                                class="fas fa-skull-crossbones"></i> EOL OS</a>
                        <a href="#" onclick="window.exportOptimizationPDF('OLD_HW_VERSION'); return false;"><i
                                class="fas fa-microchip"></i> Eski HW</a>
                        <a href="#" onclick="window.exportOptimizationPDF('VM_TOOLS'); return false;"><i
                                class="fas fa-tools"></i> VM Tools</a>
                        <a href="#" onclick="window.exportOptimizationPDF('CPU_LIMIT'); return false;"><i
                                class="fas fa-tachometer-alt"></i> CPU Limit</a>
                        <a href="#" onclick="window.exportOptimizationPDF('OLD_SNAPSHOT'); return false;"><i
                                class="fas fa-clock"></i> Eski Snapshot</a>
                        <a href="#" onclick="window.exportOptimizationPDF('LEGACY_NIC'); return false;"><i
                                class="fas fa-network-wired"></i> Eski NIC</a>
                    </div>
                </div>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="global-search" placeholder="VM ara...">
                </div>
                <div class="header-time">
                    <i class="fas fa-clock"></i>
                    <span id="current-time"></span>
                </div>
            </div>
        </header>

        <!-- Page Container -->
        <div class="page-container">
            <!-- Dashboard Page -->
            <section id="page-dashboard" class="page active">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card gradient-blue">
                        <div class="stat-icon">
                            <i class="fas fa-server"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-total-vms">0</h3>
                            <p>Toplam VM</p>
                        </div>
                    </div>
                    <div class="stat-card gradient-green">
                        <div class="stat-icon">
                            <i class="fas fa-power-off"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-powered-on">0</h3>
                            <p>Powered On</p>
                        </div>
                    </div>
                    <div class="stat-card gradient-red">
                        <div class="stat-icon">
                            <i class="fas fa-plug"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-powered-off">0</h3>
                            <p>Powered Off</p>
                        </div>
                    </div>
                    <div class="stat-card gradient-orange">
                        <div class="stat-icon">
                            <i class="fas fa-camera"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-snapshots">0</h3>
                            <p>Snapshots</p>
                        </div>
                    </div>
                    <div class="stat-card gradient-purple">
                        <div class="stat-icon">
                            <i class="fas fa-microchip"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-total-cpu">0</h3>
                            <p>Toplam vCPU</p>
                        </div>
                    </div>
                    <div class="stat-card gradient-teal">
                        <div class="stat-icon">
                            <i class="fas fa-memory"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-total-memory">0 GB</h3>
                            <p>Toplam RAM</p>
                        </div>
                    </div>
                    <div class="stat-card gradient-pink">
                        <div class="stat-icon">
                            <i class="fas fa-hdd"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-total-disk">0 TB</h3>
                            <p>Toplam Disk</p>
                        </div>
                    </div>
                    <div class="stat-card gradient-yellow">
                        <div class="stat-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-old-snapshots">0</h3>
                            <p>Eski Snapshot (7+ gün)</p>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-pie"></i> Power State Dağılımı</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="chart-powerstate"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-bar"></i> Kaynak Başına VM</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="chart-sources"></canvas>
                        </div>
                    </div>
                    <div class="chart-card wide">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-area"></i> OS Dağılımı</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="chart-os"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Source Cards -->
                <div class="section-header">
                    <h2><i class="fas fa-database"></i> Veri Kaynakları</h2>
                </div>
                <div id="sources-grid" class="sources-grid">
                    <!-- Dynamically populated -->
                </div>
            </section>

            <!-- VMs Page -->
            <section id="page-vms" class="page">
                <!-- Filtered Summary -->
                <div class="report-summary" style="margin-bottom: 20px;">
                    <div class="summary-card gradient-blue" style="padding: 15px;">
                        <i class="fas fa-server"></i>
                        <div>
                            <h3 id="filt-vm-count">0</h3>
                            <p>VM Sayısı</p>
                        </div>
                    </div>
                    <div class="summary-card gradient-purple" style="padding: 15px;">
                        <i class="fas fa-microchip"></i>
                        <div>
                            <h3 id="filt-vm-cpu">0</h3>
                            <p>Toplam vCPU</p>
                        </div>
                    </div>
                    <div class="summary-card gradient-teal" style="padding: 15px;">
                        <i class="fas fa-memory"></i>
                        <div>
                            <h3 id="filt-vm-ram">0 GB</h3>
                            <p>Toplam RAM</p>
                        </div>
                    </div>
                    <div class="summary-card gradient-pink" style="padding: 15px;">
                        <i class="fas fa-hdd"></i>
                        <div>
                            <h3 id="filt-vm-disk">0 GB</h3>
                            <p>Toplam Disk</p>
                        </div>
                    </div>
                </div>

                <div class="page-header">
                    <div class="filter-bar">
                        <div class="filter-group">
                            <label>Power State</label>
                            <select id="filter-powerstate">
                                <option value="">Tümü</option>
                                <option value="poweredOn">Powered On</option>
                                <option value="poweredOff">Powered Off</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Cluster</label>
                            <select id="filter-cluster">
                                <option value="">Tümü</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Host</label>
                            <select id="filter-host">
                                <option value="">Tümü</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>OS</label>
                            <select id="filter-os">
                                <option value="">Tümü</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Ara</label>
                            <input type="text" id="filter-vm-search" placeholder="VM Ara...">
                        </div>
                        <button class="btn btn-primary" id="btn-filter-vms">
                            <i class="fas fa-filter"></i> Filtrele
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table" id="vms-table">
                        <thead>
                            <tr>
                                <th class="sortable" data-key="VM">VM Adı <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="Powerstate">Durum <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="CPUs">vCPU <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="Memory">RAM (MB) <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="Total disk capacity MiB">Disk (MiB) <i
                                        class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="OS according to the configuration file">OS <i
                                        class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="Host">Host <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="Source">Kaynak <i class="fas fa-sort"></i></th>
                                <th>İşlem</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Dynamically populated -->
                        </tbody>
                    </table>
                </div>
            </section>


            <!-- Hosts & Clusters Page (vCenter Style) -->
            <section id="page-hosts-clusters" class="page">
                <div class="hc-container">
                    <div class="hc-sidebar">
                        <div class="hc-search">
                            <i class="fas fa-search"></i>
                            <input type="text" id="hc-search-input" placeholder="Ara...">
                        </div>
                        <div id="hc-tree" class="hc-tree">
                            <!-- Tree populated via JS -->
                        </div>
                    </div>
                    <div class="hc-content">
                        <div id="hc-detail-view">
                            <div class="empty-state">
                                <i class="fas fa-cubes"></i>
                                <p>Hosts & Clusters verisi yükleniyor...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>


            <!-- Datastores Page -->
            <section id="page-datastores" class="page">
                <div class="table-container">
                    <table class="data-table" id="datastores-table">
                        <thead>
                            <tr>
                                <th class="sortable" data-key="Name">Datastore <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="Type">Type <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="Capacity MiB">Capacity (GB) <i class="fas fa-sort"></i>
                                </th>
                                <th class="sortable" data-key="Free MiB">Free (GB) <i class="fas fa-sort"></i></th>
                                <th class="sortable">Free % <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="# VMs">VMs <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="# Hosts">Hosts <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-key="Source">Kaynak <i class="fas fa-sort"></i></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Optimization Page -->
            <section id="page-optimization" class="page">

                <!-- Quick Navigation -->
                <div class="quick-nav">
                    <button onclick="window.scrollTo({top: 0, behavior: 'smooth'}); window.filterRightSizing('');"
                        class="nav-pill active">
                        <i class="fas fa-home"></i> Tümü
                    </button>
                    <button onclick="window.filterRightSizing('POWERED_OFF_DISK')" class="nav-pill nav-pill-warning">
                        <i class="fas fa-power-off"></i> Kapalı VM
                    </button>
                    <button onclick="window.filterRightSizing('CPU_UNDERUTILIZED')" class="nav-pill">
                        <i class="fas fa-chart-line"></i> Düşük CPU
                    </button>
                    <button onclick="window.filterRightSizing('EOL_OS')" class="nav-pill nav-pill-danger">
                        <i class="fas fa-skull-crossbones"></i> EOL OS
                    </button>
                    <button onclick="window.filterRightSizing('OLD_HW_VERSION')" class="nav-pill nav-pill-warning">
                        <i class="fas fa-microchip"></i> Eski HW
                    </button>
                    <button onclick="window.filterRightSizing('VM_TOOLS')" class="nav-pill nav-pill-danger">
                        <i class="fas fa-tools"></i> VM Tools
                    </button>
                    <button onclick="window.filterRightSizing('CPU_LIMIT')" class="nav-pill nav-pill-warning">
                        <i class="fas fa-tachometer-alt"></i> CPU Limit
                    </button>
                    <button onclick="window.filterRightSizing('OLD_SNAPSHOT')" class="nav-pill nav-pill-danger">
                        <i class="fas fa-clock"></i> Eski Snapshot
                    </button>
                    <button onclick="window.filterRightSizing('LEGACY_NIC')" class="nav-pill">
                        <i class="fas fa-network-wired"></i> Eski NIC
                    </button>
                    <button onclick="document.getElementById('opt-diskwaste').scrollIntoView({behavior: 'smooth'})"
                        class="nav-pill">
                        <i class="fas fa-trash-alt"></i> Disk Waste
                    </button>
                    <button onclick="document.getElementById('opt-zombies').scrollIntoView({behavior: 'smooth'})"
                        class="nav-pill">
                        <i class="fas fa-ghost"></i> Zombies
                    </button>
                </div>

                <!-- quick-nav is here -->

                <!-- Resource Savings Summary -->
                <div class="savings-dashboard">
                    <div class="savings-card gradient-blue">
                        <div class="savings-icon"><i class="fas fa-microchip"></i></div>
                        <div class="savings-info">
                            <h3>vCPU Tasarrufu</h3>
                            <div class="savings-value" id="summary-cpu-savings">0 <small>vCPU</small></div>
                            <p>Right-Sizing & App Optimization</p>
                        </div>
                    </div>

                    <div class="savings-card gradient-purple">
                        <div class="savings-icon"><i class="fas fa-memory"></i></div>
                        <div class="savings-info">
                            <h3>RAM Tasarrufu</h3>
                            <div class="savings-value" id="summary-ram-savings">0 <small>GB</small></div>
                            <p>Right-Sizing & Power Off</p>
                        </div>
                    </div>

                    <div class="savings-card gradient-green">
                        <div class="savings-icon"><i class="fas fa-hdd"></i></div>
                        <div class="savings-info">
                            <h3>Disk Tasarrufu</h3>
                            <div class="savings-value" id="summary-disk-savings">0 <small>GB</small></div>
                            <p>Snapshots, Waste & Zombies</p>
                        </div>
                    </div>

                    <div class="savings-card gradient-red">
                        <div class="savings-icon"><i class="fas fa-search-dollar"></i></div>
                        <div class="savings-info">
                            <h3>Optimize Edilecek VM</h3>
                            <div class="savings-value" id="summary-total-vms">0</div>
                            <p>Toplam Tespit</p>
                        </div>
                    </div>
                </div>

                <!-- Right-Sizing Recommendations -->
                <div id="opt-rightsizing" class="optimization-section">
                    <h3 class="section-title">
                        <i class="fas fa-balance-scale"></i> Right-Sizing Recommendations
                        <span class="badge badge-info" id="rightsizing-count">0</span>
                    </h3>
                    <div class="table-container">
                        <table class="data-table" id="rightsizing-table">
                            <thead>
                                <tr>
                                    <th class="sortable">VM <i class="fas fa-sort"></i></th>
                                    <th class="sortable">Severity <i class="fas fa-sort"></i></th>
                                    <th class="sortable">Type <i class="fas fa-sort"></i></th>
                                    <th>Reason</th>
                                    <th class="sortable">Current <i class="fas fa-sort"></i></th>
                                    <th class="sortable">Recommended <i class="fas fa-sort"></i></th>
                                    <th class="sortable">Savings <i class="fas fa-sort"></i></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Disk Waste Analysis -->
                <div id="opt-diskwaste" class="optimization-section">
                    <h3 class="section-title">
                        <i class="fas fa-trash-alt"></i> Disk Waste Analysis
                    </h3>
                    <div class="waste-summary">
                        <div class="summary-card gradient-pink">
                            <i class="fas fa-hdd"></i>
                            <div>
                                <h3 id="disk-waste-total">0 GB</h3>
                                <p>Estimated Waste</p>
                            </div>
                        </div>
                        <div class="summary-card gradient-orange">
                            <i class="fas fa-list"></i>
                            <div>
                                <h3 id="disk-waste-count">0</h3>
                                <p>Wasteful Disks</p>
                            </div>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="disk-waste-table">
                            <thead>
                                <tr>
                                    <th>VM</th>
                                    <th>Disk</th>
                                    <th>Waste Type</th>
                                    <th>Capacity</th>
                                    <th>Wasted Space</th>
                                    <th>Provisioning</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Zombie Disks Analysis -->
                <div id="opt-zombies" class="optimization-section">
                    <h3 class="section-title">
                        <i class="fas fa-ghost"></i> Zombie Disks
                    </h3>
                    <div class="waste-summary">
                        <div class="summary-card gradient-red">
                            <i class="fas fa-skull-crossbones"></i>
                            <div>
                                <h3 id="opt-zombie-count">0</h3>
                                <p>Zombie Diskler</p>
                            </div>
                        </div>
                        <div class="summary-card gradient-purple">
                            <i class="fas fa-server"></i>
                            <div>
                                <h3 id="opt-zombie-vm-count">0</h3>
                                <p>İlişkili VM</p>
                            </div>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="opt-zombie-table">
                            <thead>
                                <tr>
                                    <th>Silinen VM Klasörü</th>
                                    <th>Cluster</th>
                                    <th>Datastore</th>
                                    <th>Disk Dosyası</th>
                                    <th>Neden Zombie?</th>
                                    <th>Kaynak</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- VM Detail Modal -->
    <div id="vm-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-vm-name">VM Details</h2>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="vm-detail-tabs">
                    <button class="vm-tab-btn active" data-vmtab="vmtab-info">
                        <i class="fas fa-info-circle"></i> Genel Bilgi
                    </button>
                    <button class="vm-tab-btn" data-vmtab="vmtab-disks">
                        <i class="fas fa-hdd"></i> Diskler
                    </button>
                    <button class="vm-tab-btn" data-vmtab="vmtab-network">
                        <i class="fas fa-network-wired"></i> Network
                    </button>
                    <button class="vm-tab-btn" data-vmtab="vmtab-snapshots">
                        <i class="fas fa-camera"></i> Snapshots
                    </button>
                </div>

                <!-- VM Info Tab -->
                <div id="vmtab-info" class="vm-tab-content active">
                    <!-- Resource Summary Cards -->
                    <div id="vm-resource-summary"
                        style="display: flex; gap: 16px; margin-bottom: 24px; flex-wrap: wrap;">
                        <!-- Injected via JS -->
                    </div>

                    <div class="vm-info-grid" id="vm-info-grid">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <!-- VM Disks Tab -->
                <div id="vmtab-disks" class="vm-tab-content">
                    <table class="data-table compact" id="vm-disks-table">
                        <thead>
                            <tr>
                                <th>Disk</th>
                                <th>Kapasite (MiB)</th>
                                <th>Thin</th>
                                <th>Mode</th>
                                <th>Controller</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <!-- VM Network Tab -->
                <div id="vmtab-network" class="vm-tab-content">
                    <table class="data-table compact" id="vm-network-table">
                        <thead>
                            <tr>
                                <th>Adapter</th>
                                <th>Network</th>
                                <th>MAC Address</th>
                                <th>IP Address</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <!-- VM Snapshots Tab -->
                <div id="vmtab-snapshots" class="vm-tab-content">
                    <table class="data-table compact" id="vm-snapshots-table">
                        <thead>
                            <tr>
                                <th>Snapshot Adı</th>
                                <th>Tarih</th>
                                <th>Boyut (MiB)</th>
                                <th>Açıklama</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modular JavaScript -->
    <script type="module" src="js/app.js"></script>
</body>

</html>